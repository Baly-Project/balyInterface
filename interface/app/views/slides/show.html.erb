<%= turbo_frame_tag 'slide-page', src: "/slides/source/#{@preview.sorting_number}" do %>

<%content_for :for_head do %>
<script>
  if (sessionStorage["fullscreen"]=="true"){
    document.querySelector("html").innerHTML = "<div id='blackscreen' style='width:100svw; height: 100svh; background-color:black;postion:fixed; z-index=100'> </div>"+document.querySelector("html").innerHTML;
  }
</script>
<% end %>



<% content_for :above_content do %>
  <%= turbo_frame_tag 'carousel', src: "/slides/source/#{@preview.sorting_number}", loading: :lazy do %>
    <div class="imageholder">
      <div class="main-image"></div>
    </div>
  <% end %>
<% end %>

  <style>
    body {
      background-color: black;
    }
  </style>

    <div class="row">
    <div class="img-info col-9">
      <% title = @preview.title
         cleantitle = title[title.index(" ")..]
      %>
      <h3 class="title"> <%= cleantitle %></h3>
    <% [2,5,3].each do |length| %>
      <h5 class="subtitle"> 
        <div class="fake-text title shimmer"></div>
        <hr class="itemline"> 
      </h5>
      <p class="sdesc">
        <% (1..length).each do %>
          <span class="fake-text desc shimmer"></span><br>
        <% end %>
      </p>
    <% end %>
    </div>
    <div class="img-data col-3">
      <div class="ext-links">
        <a title="Download Image" role="button" href="#">
          <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-box-arrow-in-down" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M3.5 6a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 1 0-1h2A1.5 1.5 0 0 1 14 6.5v8a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 14.5v-8A1.5 1.5 0 0 1 3.5 5h2a.5.5 0 0 1 0 1z"/>
            <path fill-rule="evenodd" d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708z"/>
          </svg>
        </a>
        <a title="View on Digital Kenyon" role="button" href="#" target="_blank" rel="noreferrer noopener">
          <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-box-arrow-up" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M3.5 6a.5.5 0 0 0-.5.5v8a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5v-8a.5.5 0 0 0-.5-.5h-2a.5.5 0 0 1 0-1h2A1.5 1.5 0 0 1 14 6.5v8a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 14.5v-8A1.5 1.5 0 0 1 3.5 5h2a.5.5 0 0 1 0 1z"/>
            <path fill-rule="evenodd" d="M7.646.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 1.707V10.5a.5.5 0 0 1-1 0V1.707L5.354 3.854a.5.5 0 1 1-.708-.708z"/>
          </svg>
        </a>
        <a title="Enter Fullscreen" role="button" id="fullscreen-button" href="#">
          <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-arrows-move" viewBox="0 0 16 16">
            <path fill-rule="evenodd" d="M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10M.146 8.354a.5.5 0 0 1 0-.708l2-2a.5.5 0 1 1 .708.708L1.707 7.5H5.5a.5.5 0 0 1 0 1H1.707l1.147 1.146a.5.5 0 0 1-.708.708zM10 8a.5.5 0 0 1 .5-.5h3.793l-1.147-1.146a.5.5 0 0 1 .708-.708l2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L14.293 8.5H10.5A.5.5 0 0 1 10 8"/>
          </svg>
        </a>
      </div>
      <div class="additional-data">
        <div class="data-item">
          <span class="data-bold"> Identifier </span>
          <span class="data"> <span class="fake-text desc shimmer"</span></span>
        </div>
        <div class="data-item">
          <span class="data-bold">Collection</span>
          <a class="data" role="button" href="/collections/<%= @preview.collection.alph_value%>"> <%= @preview.collection.title %></a>
        </div>
        <div class="data-item">
          <span class="data-bold"> Location </span>
          <a class="data" role="button"> <%= @preview.city.generateSearchEntry[0] %></span>
        </div>
        <div class="data-item">
          <span class="data-bold"> Year </span>
          <% thisyear = @preview.year.number %>
          <a class="data" role="button" href="/years/<%=thisyear %>"> <%= @preview.year.number %> </a>
        </div>
        <% unless @preview.stamp.title == "unstamped" %>
          <% stamp = @preview.stamp %>
        <div class= "data-item">
          <span class="data-bold"> Batch Stamp </span>
          <a class="data" role="button" href="/stamps/<%=stamp.id%>"> <%=stamp.title%> </a>
        </div>
        <% end %>

        <div class="data-item">
          <span class="data-bold"> Keywords </span>
          <span class="data">
          <% (1..5).each do %>
            <a class="nowrap" role="button"><span class="fake-text desc shimmer"></span></a>,
            <hr class="keyword-sep">
          <% end %>
          </span>
        </div>

        <div class="expander-container">
          <a type="button" class="data" class="help-button" href="javascript:void(0)" data-bs-container="body" data-bs-toggle="popover" data-bs-placement="left"
              data-bs-content="Use the arrow keys and buttons on either side of the image to go
              back/forth within the collection, or use the links on
              the right to see other slides with that property.">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-question-circle" viewBox="0 0 16 16">
              <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
              <path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286m1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94"/>
            </svg>
          </a>
          <a id="expander" class="expand-button" role="button" href="javascript:void(0)">
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-plus" viewBox="0 0 16 16">
              <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/>
            </svg>
          </a>
      </div>
    </div>
  </div>

  <div class="hidden" style="display:none;">
    <%=image_tag("marker-icon-green.png", id:"green-icon") %>
    <%=image_tag("marker-icon-blue.png", id:"blue-icon") %>
    <%=image_tag("marker-icon-orange.png", id:"orange-icon") %>
    <%=image_tag("marker-shadow.png", id:"shadow-icon") %>
    <%=image_tag("fov.png",id:"fov-icon") %>
  </div>
<% end %>
